CREATE TABLE bill (
  Bill_ID varchar(55) NOT NULL,
  Bill_Type varchar(55) NOT NULL,
  Amount_Due int NOT NULL,
  Due_Date varchar(55) NOT NULL,
  Payment_Status varchar(55) NOT NULL,
  StudentID varchar(55) NOT NULL,
  PersonalID_O varchar(55) NOT NULL,
  PRIMARY KEY (Bill_ID),
  KEY StudentID (StudentID),
  KEY PersonalID_O (PersonalID_O),
  FOREIGN KEY (StudentID) REFERENCES student (StudentID),
  FOREIGN KEY (PersonalID_O) REFERENCES office_staff (PersonalID_O)
) 
INSERT INTO Bill  VALUES
('B001','Dien',500000,'2024-11-15','Chua thanh toan','SV001','000007'),
('B002','Nuoc',300000,'2024-11-20','Da thanh toan','SV002','000008'),
('B003','Su dung Internet',400000,'2024-11-25','Chua thanh toan','SV003','000009'),
('B004','Bao tri',250000,'2024-11-30','Da thanh toan','SV004','000010'),
('B005','Phat',200000,'2024-11-15','Chua thanh toan','SV005','000011'),
('B006','Tien phong',3000000,'2024-11-20','Da thanh toan','SV006','000012'),
('B007','Dien',510000,'2024-11-25','Chua thanh toan','SV007','000007'),
('B008','Nuoc',310000,'2024-11-30','Da thanh toan','SV008','000008'),
('B009','Su dung Internet',410000,'2024-11-15','Chua thanh toan','SV009','000009'),
('B010','Bao tri',260000,'2024-11-20','Da thanh toan','SV010','000010'),
('B011','Phat',210000,'2024-11-25','Chua thanh toan','SV011','000011'),
('B012','Tien phong',3100000,'2024-11-30','Da thanh toan','SV012','000012'),
('B013','Dien',520000,'2024-11-15','Chua thanh toan','SV013','000007'),
('B014','Nuoc',320000,'2024-11-20','Da thanh toan','SV014','000008'),
('B015','Su dung Internet',420000,'2024-11-25','Chua thanh toan','SV015','000009'),
('B016','Bao tri',270000,'2024-11-30','Da thanh toan','SV016','000010'),
('B017','Phat',220000,'2024-11-15','Chua thanh toan','SV017','000011'),
('B018','Tien phong',3200000,'2024-11-20','Da thanh toan','SV018','000012'),
('B019','Dien',530000,'2024-11-25','Chua thanh toan','SV019','000007'),
('B020','Nuoc',330000,'2024-11-30','Da thanh toan','SV020','000008'),
('B021','Su dung Internet',430000,'2024-11-15','Chua thanh toan','SV021','000009'),
('B022','Bao tri',280000,'2024-11-20','Da thanh toan','SV022','000010'),
('B023','Phat',230000,'2024-11-25','Chua thanh toan','SV023','000011'),
('B024','Tien phong',3300000,'2024-11-30','Da thanh toan','SV024','000012'),
('B025','Dien',540000,'2024-11-15','Chua thanh toan','SV025','000007'),
('B026','Nuoc',340000,'2024-11-20','Da thanh toan','SV026','000008'),
('B027','Su dung Internet',440000,'2024-11-25','Chua thanh toan','SV027','000009'),
('B028','Bao tri',290000,'2024-11-30','Da thanh toan','SV028','000010'),
('B029','Phat',240000,'2024-11-15','Chua thanh toan','SV029','000011'),
('B030','Tien phong',3400000,'2024-11-20','Da thanh toan','SV030','000012'),
('B031','Dien',550000,'2024-11-25','Chua thanh toan','SV031','000007'),
('B032','Nuoc',350000,'2024-11-30','Da thanh toan','SV032','000008'),
('B033','Su dung Internet',450000,'2024-11-15','Chua thanh toan','SV033','000009'),
('B034','Bao tri',300000,'2024-11-20','Da thanh toan','SV034','000010'),
('B035','Phat',250000,'2024-11-25','Chua thanh toan','SV035','000011'),
('B036','Tien phong',3500000,'2024-11-30','Da thanh toan','SV036','000012'),
('B037','Dien',560000,'2024-11-15','Chua thanh toan','SV037','000007'),
('B038','Nuoc',360000,'2024-11-20','Da thanh toan','SV038','000008'),
('B039','Su dung Internet',460000,'2024-11-25','Chua thanh toan','SV039','000009'),
('B040','Bao tri',310000,'2024-11-30','Da thanh toan','SV040','000010'),
('B041','Phat',100000,'2024-12-15','Chua thanh toan','SV041','000011'),
('B042','Tien phong',1800000,'2024-12-20','Da thanh toan','SV042','000012'),
('B043','Dien',550000,'2024-12-10','Chua thanh toan','SV043','000007'),
('B044','Nuoc',180000,'2024-12-05','Da thanh toan','SV044','000008'),
('B045','Su dung Internet',280000,'2024-12-15','Da thanh toan','SV045','000009'),
('B046','Bao tri',150000,'2024-12-20','Chua thanh toan','SV046','000010'),
('B047','Phat',120000,'2024-12-10','Da thanh toan','SV047','000011'),
('B048','Tien phong',2400000,'2024-12-05','Chua thanh toan','SV048','000012'),
('B049','Dien',520000,'2024-12-15','Chua thanh toan','SV049','000007'),
('B050','Nuoc',190000,'2024-12-20','Da thanh toan','SV050','000008'),
('B051','Su dung Internet',330000,'2024-12-10','Da thanh toan','SV001','000009'),
('B052','Bao tri',180000,'2024-12-05','Chua thanh toan','SV002','000010'),
('B053','Phat',95000,'2024-12-15','Da thanh toan','SV003','000011'),
('B054','Tien phong',2300000,'2024-12-20','Chua thanh toan','SV004','000012'),
('B055','Dien',600000,'2024-12-10','Da thanh toan','SV005','000007'),
('B056','Nuoc',250000,'2024-12-05','Chua thanh toan','SV006','000008'),
('B057','Su dung Internet',350000,'2024-12-15','Chua thanh toan','SV007','000009'),
('B058','Bao tri',190000,'2024-12-20','Da thanh toan','SV008','000010'),
('B059','Phat',100000,'2024-12-10','Chua thanh toan','SV009','000011'),
('B060','Tien phong',2200000,'2024-12-05','Da thanh toan','SV010','000012'),
('B061','Dien',550000,'2024-12-15','Chua thanh toan','SV011','000007'),
('B062','Nuoc',230000,'2024-12-20','Da thanh toan','SV012','000008'),
('B063','Su dung Internet',330000,'2024-12-10','Da thanh toan','SV013','000009'),
('B064','Bao tri',170000,'2024-12-05','Chua thanh toan','SV014','000010'),
('B065','Phat',110000,'2024-12-15','Da thanh toan','SV015','000011'),
('B066','Tien phong',2400000,'2024-12-20','Chua thanh toan','SV016','000012'),
('B067','Dien',500000,'2024-12-10','Da thanh toan','SV017','000007'),
('B068','Nuoc',200000,'2024-12-05','Chua thanh toan','SV018','000008'),
('B069','Su dung Internet',310000,'2024-12-15','Chua thanh toan','SV019','000009'),
('B070','Bao tri',160000,'2024-12-20','Da thanh toan','SV020','000010'),
('B071','Phat',130000,'2024-12-10','Chua thanh toan','SV021','000011'),
('B072','Tien phong',2500000,'2024-12-05','Da thanh toan','SV022','000012'),
('B073','Dien',490000,'2024-12-15','Chua thanh toan','SV023','000007'),
('B074','Nuoc',220000,'2024-12-20','Da thanh toan','SV024','000008'),
('B075','Su dung Internet',300000,'2024-12-10','Chua thanh toan','SV025','000009'),
('B076','Bao tri',150000,'2024-12-05','Da thanh toan','SV026','000010'),
('B077','Phat',140000,'2024-12-15','Chua thanh toan','SV027','000011'),
('B078','Tien phong',2600000,'2024-12-20','Da thanh toan','SV028','000012'),
('B079','Dien',480000,'2024-12-10','Chua thanh toan','SV029','000007'),
('B080','Nuoc',210000,'2024-12-05','Da thanh toan','SV030','000008'),
('B081','Su dung Internet',290000,'2024-12-15','Chua thanh toan','SV031','000009'),
('B082','Bao tri',140000,'2024-12-20','Da thanh toan','SV032','000010'),
('B083','Phat',150000,'2024-12-10','Chua thanh toan','SV033','000011'),
('B084','Tien phong',2700000,'2024-12-05','Da thanh toan','SV034','000012'),
('B085','Dien',470000,'2024-12-15','Chua thanh toan','SV035','000007'),
('B086','Nuoc',200000,'2024-12-20','Da thanh toan','SV036','000008'),
('B087','Su dung Internet',280000,'2024-12-10','Chua thanh toan','SV037','000009'),
('B088','Bao tri',130000,'2024-12-05','Da thanh toan','SV038','000010'),
('B089','Phat',160000,'2024-12-15','Chua thanh toan','SV039','000011'),
('B090','Tien phong',2800000,'2024-12-20','Da thanh toan','SV040','000012'),
('B091','Dien',460000,'2024-12-10','Chua thanh toan','SV041','000007'),
('B092','Nuoc',190000,'2024-12-05','Da thanh toan','SV042','000008'),
('B093','Su dung Internet',270000,'2024-12-15','Chua thanh toan','SV043','000009'),
('B094','Bao tri',120000,'2024-12-20','Da thanh toan','SV044','000010'),
('B095','Phat',170000,'2024-12-10','Chua thanh toan','SV045','000011'),
('B096','Tien phong',2900000,'2024-12-05','Da thanh toan','SV046','000012'),
('B097','Dien',450000,'2024-12-15','Chua thanh toan','SV047','000007'),
('B098','Nuoc',180000,'2024-12-20','Da thanh toan','SV048','000008'),
('B099','Su dung Internet',260000,'2024-12-10','Chua thanh toan','SV049','000009'),
('B100','Bao tri',110000,'2024-12-05','Da thanh toan','SV050','000010'),
('B101','Phat',180000,'2024-12-15','Chua thanh toan','SV001','000011'),
('B102','Tien phong',3000000,'2024-12-20','Da thanh toan','SV002','000012'),
('B103','Dien',440000,'2024-12-10','Chua thanh toan','SV003','000007'),
('B104','Nuoc',170000,'2024-12-05','Da thanh toan','SV004','000008'),
('B105','Su dung Internet',250000,'2024-12-15','Chua thanh toan','SV005','000009'),
('B106','Bao tri',100000,'2024-12-20','Da thanh toan','SV006','000010'),
('B107','Phat',190000,'2024-12-10','Chua thanh toan','SV007','000011'),
('B108','Tien phong',3100000,'2024-12-05','Da thanh toan','SV008','000012'),
('B109','Dien',430000,'2024-12-15','Chua thanh toan','SV009','000007'),
('B110','Nuoc',160000,'2024-12-20','Da thanh toan','SV010','000008'),
('B111','Su dung Internet',240000,'2024-12-10','Chua thanh toan','SV011','000009'),
('B112','Bao tri',90000,'2024-12-05','Da thanh toan','SV012','000010'),
('B113','Phat',200000,'2024-12-15','Chua thanh toan','SV013','000011'),
('B114','Tien phong',3200000,'2024-12-20','Da thanh toan','SV014','000012'),
('B115','Dien',420000,'2024-12-10','Chua thanh toan','SV015','000007'),
('B116','Nuoc',150000,'2024-12-05','Da thanh toan','SV016','000008'),
('B117','Su dung Internet',230000,'2024-12-15','Chua thanh toan','SV017','000009'),
('B118','Bao tri',80000,'2024-12-20','Da thanh toan','SV018','000010'),
('B119','Phat',210000,'2024-12-10','Chua thanh toan','SV019','000011'),
('B120','Tien phong',3300000,'2024-12-05','Da thanh toan','SV020','000012'),
('B121','Dien',410000,'2024-12-15','Chua thanh toan','SV021','000007'),
('B122','Nuoc',140000,'2024-12-20','Da thanh toan','SV022','000008'),
('B123','Su dung Internet',220000,'2024-12-10','Chua thanh toan','SV023','000009'),
('B124','Bao tri',70000,'2024-12-05','Da thanh toan','SV024','000010'),
('B125','Phat',220000,'2024-12-15','Chua thanh toan','SV025','000011'),
('B126','Tien phong',3400000,'2024-12-20','Da thanh toan','SV026','000012'),
('B127','Dien',400000,'2024-12-10','Chua thanh toan','SV027','000007'),
('B128','Nuoc',130000,'2024-12-05','Da thanh toan','SV028','000008'),
('B129','Su dung Internet',210000,'2024-12-15','Chua thanh toan','SV029','000009'),
('B130','Bao tri',60000,'2024-12-20','Da thanh toan','SV030','000010'),
('B131','Phat',230000,'2024-12-10','Chua thanh toan','SV031','000011'),
('B132','Tien phong',3500000,'2024-12-05','Da thanh toan','SV032','000012'),
('B133','Dien',390000,'2024-12-15','Chua thanh toan','SV033','000007'),
('B134','Nuoc',120000,'2024-12-20','Da thanh toan','SV034','000008'),
('B135','Su dung Internet',200000,'2024-12-10','Chua thanh toan','SV035','000009'),
('B136','Bao tri',50000,'2024-12-05','Da thanh toan','SV036','000010'),
('B137','Phat',240000,'2024-12-15','Chua thanh toan','SV037','000011'),
('B138','Tien phong',3600000,'2024-12-20','Da thanh toan','SV038','000012'),
('B139','Dien',380000,'2024-12-10','Chua thanh toan','SV039','000007'),
('B140','Nuoc',110000,'2024-12-05','Da thanh toan','SV040','000008'),
('B141','Su dung Internet',190000,'2024-12-15','Chua thanh toan','SV041','000009'),
('B142','Bao tri',40000,'2024-12-20','Da thanh toan','SV042','000010'),
('B143','Phat',250000,'2024-12-10','Chua thanh toan','SV043','000011'),
('B144','Tien phong',3700000,'2024-12-05','Da thanh toan','SV044','000012'),
('B145','Dien',370000,'2024-12-15','Chua thanh toan','SV045','000007'),
('B146','Nuoc',100000,'2024-12-20','Da thanh toan','SV046','000008'),
('B147','Su dung Internet',180000,'2024-12-10','Chua thanh toan','SV047','000009'),
('B148','Bao tri',30000,'2024-12-05','Da thanh toan','SV048','000010'),
('B149','Phat',260000,'2024-12-15','Chua thanh toan','SV049','000011'),
('B150','Tien phong',3500000,'2024-12-10','Da thanh toan','SV050','000012');


--Query 1
SELECT 
    b.Bill_ID,
    b.Bill_Type,
    b.Amount_Due,
    s.StudentID,
    s.LastName,
    s.EmailAddress AS StudentEmail,
    s.phoneNumber AS StudentPhoneNumber
FROM 
    bill b
JOIN 
    student s ON b.StudentID = s.StudentID
WHERE 
    b.Payment_Status <> 'Đã thanh toán'
    AND b.Due_Date > CURDATE();
